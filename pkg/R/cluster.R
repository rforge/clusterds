## wrapper fo cluster functions

cluster <- function(dsc, dsd, n=1000) { 
  if (n < 2)
    stop("numPoints must be > 1")

  # looping through the stream, feeding the new datapoints into 
  # the algorithm
  for (i in 1:n) {
    inst <- get_points(dsd)
    .cluster(dsc, inst)
	
	##TODO: BUG- DSD_DataFrame stopping at 98 out of 100 data points in a stream
	##print(i)
	
    # so cl <- cluster(cl, ...) also works
    invisible(dsc)
  }
}

.cluster <- function(dsc, inst) UseMethod(".cluster")

.cluster.DSC_MOA <- function(dsc, inst) {
	inst <- .jnew("weka/core/Instance", 1.0, inst[1,])
    .jcall(dsc$javaObj, "V", "trainOnInstanceImpl", inst)
	invisible(dsc)
}

.cluster.DSC_R <- function(dsc, inst) {
	dsc <- dsc$clusterFun(dsc, inst)
	invisible(dsc)
}

